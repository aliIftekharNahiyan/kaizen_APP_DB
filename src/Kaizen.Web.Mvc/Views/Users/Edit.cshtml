@using Abp.Authorization.Users;
@using Kaizen.Enums;
@using Kaizen.Web.Models.FundingBodys;
@using Kaizen.Web.Models.SessionGroups;
@using Kaizen.Web.Models.SupportSessions
@using Kaizen.Web.Models.SupportTypes;
@using Kaizen.Web.Models.Universitys;

@using Kaizen.Web.Startup;
@using Kaizen.Web.Models.Users;
@model UserEditViewModel
@{
    ViewBag.Title = L("EditUser");
    ViewBag.CurrentPageName = PageNames.Users;
}

@section scripts
    {
    <environment names="Development">
        <script src="~/view-resources/Views/Address/Edit.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Users/Edit.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Histories/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/University/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SessionGroup/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SupportTypes/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/FundingBody/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SupportSession/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Notes/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/UserKin/Index.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/paymentterm/index.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/customertype/index.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/regionlocation/index.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/skill/index.js" asp-append-version="true"></script>
    </environment>

    <environment names="Staging,Production">
        <script src="~/view-resources/Views/Address/Edit.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Users/Edit.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Histories/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/University/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SessionGroup/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SupportTypes/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/FundingBody/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/Notes/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/UserKin/Index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/paymentterm/index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/customertype/index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/regionlocation/index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/views/skill/index.min.js" asp-append-version="true"></script>
        <script src="~/view-resources/Views/SupportSession/Index.min.js" asp-append-version="true"></script>
    </environment>

    <script>
        new Helpers().setupSelects([University, Skill, SupportType, FundingBody]);

    </script>
    <script>
        $('#Pronoun-add-click').hide();
        $('#UserType-add-click').hide();
        $('#Skill-add-click').hide();
        $('#User-add-click').hide();
        $('#WorkRegionLocation-add-click').hide();
        $('#RegionLocation-add-click').hide();
        $('#PaymentTerm-add-click').hide();
        $('#CustomerType-add-click').hide();

        new UserKin().setupGrid();
        new User().setupGrid();
    </script>
}


<input type="hidden" id="EntityType" value="@(typeof(Kaizen.Authorization.Users.User))" />

<section class="content-header">
    <div class="container-fluid">
        <div class="row mb-3">
            <div class="col-md-6">
                <h4>@Model.User.Name @Model.User.Surname</h4>
            </div>
            <div class="col-md-6">
                <div class="btn-group float-end" role="group">
                    <div class="btn-group" role="group">
                        <button id="btnActionsDropdown" type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                            Actions <i class="mdi mdi-chevron-down"></i>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="btnActionsDropdown">
                            <li><a class="dropdown-item" href="javascript:;" data-bs-toggle="modal" data-bs-target="#NoteCreateModal" data-function="notes" data-entity-id="@Model.User.Id" data-entity-type="@(typeof(Kaizen.Authorization.Users.User))">View Notes</a></li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" role="tab" href="#edit-user-details">
                                <span class="d-none d-sm-block">@L("UserDetails")</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" role="tab" href="#edit-user-addresses">
                                <span class="d-none d-sm-block">Addresses</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Sessions</a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" data-bs-toggle="tab" role="tab" href="#edit-user-calendar">Calendar</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="tab" role="tab" href="#edit-user-sessions">Sessions List</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="tab" role="tab" href="#edit-user-session-groups">Session Groups</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" role="tab" href="#edit-user-roles">
                                <span class="d-none d-sm-block">@L("UserRoles")</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" role="tab" href="#edit-user-history">
                                <span class="d-none d-sm-block">History</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" role="tab" href="#edit-user-userkin">
                                <span class="d-none d-sm-block">User Kin</span>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content p-3 text-muted">
                        <div role="tabpanel" class="tab-pane active" id="edit-user-details">

                            <form asp-asp-controller="Users" asp-action="Edit" role="form" id="edit-user-details-form" class="form-horizontal">
                                <input type="hidden" asp-for="User.Id" />

                                <input type="hidden" id="resultStatus" value="@Model.IsSuccess" />

                                <div class="row">
                                    <div class="col-6">
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="username">@L("UserName")</label>
                                            <div class="col-md-9 required">
                                                <input asp-for="User.UserName" type="text" class="form-control" required maxlength="@AbpUserBase.MaxUserNameLength" minlength="2">
                                                <span asp-validation-for="User.UserName" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <label class="col-md-3 col-form-label" for="name">@L("Name")</label>
                                            <div class="col-md-9 required">
                                                <input asp-for="User.Name" type="text" class="form-control" required maxlength="@AbpUserBase.MaxNameLength">
                                                <span asp-validation-for="User.Name" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <label class="col-md-3 col-form-label" for="surname">@L("Surname")</label>
                                            <div class="col-md-9 required">
                                                <input asp-for="User.Surname" type="text" class="form-control" required maxlength="@AbpUserBase.MaxSurnameLength">
                                                <span asp-validation-for="User.Surname" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <label class="col-md-3 col-form-label" for="email">@L("EmailAddress")</label>
                                            <div class="col-md-9 required">
                                                <input type="email" class="form-control" asp-for="User.EmailAddress" required maxlength="@AbpUserBase.MaxEmailAddressLength">
                                                <span asp-validation-for="User.EmailAddress" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" asp-for="User.UniversityId">@L("University")</label>
                                            <div class="col-md-9 required">
                                                <select class="select2 form-control" required asp-for="User.UniversityId" data-service="University" data-selected-text="@Model.User.University?.Name" data-selected-value="@Model.User.UniversityId"></select>
                                                <span asp-validation-for="User.UniversityId" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.IsActive" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("IsActive")
                                                    </label>
                                                </div>
                                            </div>

                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.DpStatus" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("DpStatus")
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.AgreeTC" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("AgreeTC")
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.Archived" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("Archived")
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="MedicalHistory">@L("Medical History")</label>
                                            <div class="col-md-9">
                                                <input asp-for="User.MedicalHistory" type="text" required class="form-control" maxlength="-1">
                                                <span asp-validation-for="User.MedicalHistory" class="text-danger"></span>
                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="Pronouns">@L("Pronouns")</label>
                                            <div class="col-md-9">
                                                <select class="select2 form-control" asp-for="User.PronounId" required data-service="Pronoun" data-selected-text="@Model.User.Pronoun?.Name" data-selected-value="@Model.User.PronounId">
                                                </select>
                                                <span asp-validation-for="User.PronounId" class="text-danger"></span>

                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="Website">@L("Websites")</label>
                                            <div class="col-md-9">
                                                <input asp-for="User.Website" required type="text" class="form-control" maxlength="512">
                                                <span asp-validation-for="User.Website" class="text-danger"></span>
                                            </div>
                                        </div>
                                        <div class="mb-3 row" id="divVisiPer" style="display:none">
                                            <label class="col-md-3 col-form-label" for="Website">@L("Visibility Permission")</label>
                                            <div class="col-md-9">
                                                <select class="select2 form-control" asp-for="User.VisibilityPermissionId" data-service="VisibilityPermission" data-selected-text="@Model.User.VisibilityPermission?.Name" data-selected-value="@Model.User.VisibilityPermissionId"></select>
                                                <span asp-validation-for="User.UserName" class="text-danger"></span>
                                            </div>
                                        </div>
                                    </div>

                                    @* SECOND COLUMN *@
                                    <div class="col-6">
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label">@L("User Skill")</label>
                                            <div class="col-md-9">


                                                <select class="select2 form-control" multiple="multiple" asp-for="User.SkillId" data-service="Skill" required>
                                                    @foreach (var tag in @Model?.User?.Skills)
                                                    {
                                                        <option selected value="@tag.Skill.Id">@tag.Skill.Name</option>
                                                    }
                                                </select>
                                                <span asp-validation-for="User.SkillId" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label">@L("Regular Client Support")</label>
                                            <div class="col-md-9">



                                                <select class="select2 form-control" multiple="multiple" asp-for="User.UserClientSupportId" data-service="User" required>
                                                    @foreach (var tag in @Model?.User?.UserClientSupports)
                                                    {
                                                        <option selected value="@tag.Clients.Id">@tag.Clients.Name</option>
                                                    }
                                                </select>
                                                <span asp-validation-for="User.UserClientSupportId" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <label class="col-md-3 col-form-label" asp-for="User.PreferredCommunicationLanguage">@L("Preferred Communication")</label>
                                            <div class="col-md-9">
                                                <label class="radio-label">
                                                    <input type="radio" asp-for="User.PreferredCommunicationLanguage" value="SMS" /> @L("SMS")
                                                </label>
                                                <label class="radio-label">
                                                    <input type="radio" asp-for="User.PreferredCommunicationLanguage" value="Email" /> @L("Email")
                                                </label>

                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="name">@L("User Type")</label>
                                            <div class="col-md-9 required">
                                                <select class="select2 form-control" required asp-for="User.UserTypeId" data-service="UserType" data-selected-text="@Model.User.UserType?.Name" data-selected-value="@Model.User.UserTypeId"></select>
                                                <span asp-validation-for="User.UserTypeId" class="text-danger"></span>
                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="name">@L("Work Area")</label>
                                            <div class="col-md-9">

                                                <select class="select2 form-control" asp-for="User.WRegionId" required data-service="WorkRegionLocation">
                                                    @foreach (var region in @Model?.User?.WorkRegionLocations)
                                                    {
                                                        <option selected value="@region.RegionLocation.Id">@region.RegionLocation.Name</option>
                                                    }
                                                </select>
                                                <span asp-validation-for="User.WRegionId" class="text-danger"></span>
                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" for="name">@L("User Location")</label>
                                            <div class="col-md-9">

                                                <select class="select2 form-control" asp-for="User.LRegionId" required data-service="RegionLocation">
                                                    @foreach (var region in @Model?.User?.LivingRegionLocations)
                                                    {
                                                        <option selected value="@region.RegionLocation.Id">@region.RegionLocation.Name</option>
                                                    }
                                                </select>
                                                <span asp-validation-for="User.LRegionId" class="text-danger"></span>
                                            </div>
                                        </div>
                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" asp-for="User.PaymentTermId">@L("Payment Type")</label>
                                            <div class="col-md-9 required">

                                                <select class="select2 form-control" required asp-for="User.PaymentTermId" data-service="PaymentTerm" data-selected-text="@Model.User.PaymentTerm?.Name" data-selected-value="@Model.User.PaymentTermId"></select>
                                                <span asp-validation-for="User.PaymentTermId" class="text-danger"></span>

                                            </div>
                                        </div>




                                        <div class="mb-3 row required">
                                            <label class="col-md-3 col-form-label" asp-for="User.CustomerTypeId">@L("Customer Type")</label>
                                            <div class="col-md-9 required">
                                                <select class="select2 form-control" asp-for="User.CustomerTypeId" required data-service="CustomerType" data-selected-text="@Model.User.CustomerType?.Name" data-selected-value="@Model.User.CustomerTypeId"></select>
                                                <span asp-validation-for="User.CustomerTypeId" class="text-danger"></span>
                                            </div>
                                        </div>

                                        <div class="mb-3 row">
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.MarketingConsent" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("MarketingConsent")
                                                    </label>
                                                </div>
                                            </div>

                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.StoreDetailsConsent" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("StoreDetailsConsent")
                                                    </label>
                                                </div>
                                            </div>
                                          @*  <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.AgreeTermsAndConditions" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("AgreeTermsAndConditions")
                                                    </label>
                                                </div>
                                            </div>*@
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.AgreePrivacyPolicy" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("AgreePrivacyPolicy")
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div class="form-check">
                                                    <input class="form-check-input" asp-for="User.DoNotContact" type="checkbox" />
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        @L("DoNotContact")
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="float-end">
                                    <a href="@Url.Action("Index","Users")"> <button type="button" class="btn btn-danger">@L("Cancel")</button></a>
                                    <button type="submit" class="btn btn-primary ml-1 save-button-details">@L("Save")</button>
                                </div>
                            </form>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-addresses">
                            <section class="content-header">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <a href="javascript:;" data-bs-toggle="modal" data-bs-target="#AddressCreateModal" class="btn btn-primary">
                                                <i class="fa fa-plus-square"></i>
                                                @L("Create")
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            @await Html.PartialAsync("~/Views/Address/Index.AdvancedSearch.cshtml")
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <div class="table-responsive">
                                <table id="AddressTable" class="table table-hover table-nowrap mb-0 align-middle table-check">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="rounded-start"></th>
                                            <th>@L("Name")</th>
                                            <th>@L("AddressLine1")</th>
                                            <th>@L("AddressLine2")</th>
                                            <th>@L("AddressLine3")</th>
                                            <th>@L("City")</th>
                                            <th>@L("County")</th>
                                            <th>@L("Postcode")</th>
                                            <th>@L("IsPrimary")</th>
                                            <th style="width: 100px" class="rounded-end"></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-calendar">
                            <section class="content-header">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <a href="javascript:;" data-bs-toggle="modal" data-bs-target="#SupportSessionCreateModal" class="btn btn-primary">
                                                <i class="fa fa-plus-square"></i>
                                                @L("Create")
                                            </a>
                                        </div>
                                        <div class="col-md-6">

                                        </div>
                                    </div>
                                </div>
                            </section>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <div id="session-calendar"></div>
                                </div>

                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-sessions">
                            <section class="content-header">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <a href="javascript:;" data-bs-toggle="modal" data-bs-target="#SupportSessionCreateModal" class="btn btn-primary">
                                                <i class="fa fa-plus-square"></i>
                                                @L("Create")
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            @await Html.PartialAsync("~/Views/SupportSessions/Index.AdvancedSearch.cshtml")
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="SupportSessionTable" class="table table-hover table-nowrap mb-0 align-middle table-check">
                                        <thead class="table-light">
                                            <tr>
                                                <th class="rounded-start"></th>
                                                <th>Session Group</th>
                                                <th>Support Type</th>
                                                <th>Funding Body</th>
                                                <th>Start Date</th>
                                                <th>End Date</th>
                                                <th>Session Type</th>
                                                <th>Status</th>
                                                <th class="no-filter rounded-end" style="width: 100px"></th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-session-groups">

                            <section class="content-header">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <a href="javascript:;" data-bs-toggle="modal" data-bs-target="#SessionGroupCreateModal" class="btn btn-primary">
                                                <i class="fa fa-plus-square"></i>
                                                @L("Create")
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            @await Html.PartialAsync("~/Views/SessionGroups/Index.AdvancedSearch.cshtml")
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="SessionGroupTable" class="table table-hover table-nowrap mb-0 align-middle table-check">
                                        <thead class="table-light">
                                            <tr>
                                                <th class="rounded-start"></th>
                                                <th>Name</th>
                                                <th>Description</th>
                                                <th>Support Type</th>
                                                <th>Funding Body</th>
                                                <th class="no-filter rounded-end" style="width: 100px"></th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>

                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-roles">
                             <form asp-asp-controller="Users" asp-action="EditRoles" role="form" class="form-horizontal">
                                <input type="hidden" asp-for="User.Id" />
                                <div class="row">
                                @foreach (var role in Model.Roles)
                                {
                                    <div class="col-md-6">
                                        <input type="checkbox" name="role" value="@role.NormalizedName" title="@role.Description" onclick="handleCheckboxClick(this)" class="filled-in" id="@($"role{role.Id}")" @(Model.UserIsInRole(role) ? "checked" : "") />
                                        <label for="@($"role{role.Id}")" title="@role.DisplayName">@role.Name</label>
                                    </div>
                                }
                            </div>
                                <div class="float-end">
                                    <button type="button" class="btn btn-danger">@L("Cancel")</button>
                                    <button type="submit" class="btn btn-primary ml-1">@L("Save")</button>
                                </div>
                            </form>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-history">
                            <div class="table-responsive">
                                <table id="HistoryTable" class="table table-hover table-nowrap mb-0 align-middle table-check">
                                    <thead class="table-light">
                                        <tr>
                                            <th class="rounded-start"></th>
                                            <th>@L("ChangedBy")</th>
                                            <th>@L("ChangeType")</th>
                                            <th>@L("CreationTime")</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="edit-user-userkin">
                            <section class="content-header">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <a href="javascript:;" data-bs-toggle="modal" data-bs-target="#UserKinCreateModal" class="btn btn-primary">
                                                <i class="fa fa-plus-square"></i>
                                                @L("Create")
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            @await Html.PartialAsync("~/Views/UserKins/Index.AdvancedSearchUserKin.cshtml")
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <div class="table-responsive">
                                <table id="kinTable" class="table table-hover table-nowrap mb-0 align-middle table-check">
                                    <thead class="table-light">
                                        <tr>
                                            @* <th class="rounded-start"></th> *@
                                            <th>@L("Name")</th>
                                            <th>@L("Relation")</th>
                                            <th>@L("ContactType")</th>

                                            <th style="width: 100px" class="rounded-end"></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@await Html.PartialAsync("~/Views/Address/_CreateModal.cshtml", Model.Addresses)
@await Html.PartialAsync("~/Views/Universitys/_CreateModal.cshtml", new UniversityListViewModel())
@await Html.PartialAsync("~/Views/SessionGroups/_CreateModal.cshtml", new SessionGroupListViewModel())
@await Html.PartialAsync("~/Views/SupportTypes/_CreateModal.cshtml", new SupportTypeListViewModel())
@await Html.PartialAsync("~/Views/FundingBodys/_CreateModal.cshtml", new FundingBodyListViewModel())
@await Html.PartialAsync("~/Views/SupportSessions/_CreateModal.cshtml", new SupportSessionListViewModel())
@await Html.PartialAsync("~/Views/Notes/_CreateModal.cshtml")
@await Html.PartialAsync("~/Views/UserKins/_CreateModalKin.cshtml",Model.UserKins)

<div class="modal fade" id="AddressEditModal" tabindex="-1" role="dialog" aria-labelledby="AddressEditModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>
<div class="modal fade" id="UserKinEditModal" tabindex="-1" role="dialog" aria-labelledby="UserKinEditModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>
<div class="modal fade" id="HistoryEditModal" tabindex="-1" role="dialog" aria-labelledby="HistoryEditModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>

<div class="modal fade" id="SessionGroupEditModal" tabindex="-1" role="dialog" aria-labelledby="SessionGroupEditModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>
<div class="modal fade" id="SupportSessionEditModal" tabindex="-1" role="dialog" aria-labelledby="SupportSessionEditModalLabel" data-backdrop="static">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
        </div>
    </div>
</div>

<script>
    function handleCheckboxClick(checkbox) {
        var isChecked = checkbox.checked;
        var checkboxValue = checkbox.value;


        console.log("Checkbox checked:", isChecked);
        if (checkboxValue == 'CUSTOMER' || checkboxValue == 'NON MEDICAL HELPER') {
            if (isChecked) {
                $("#divVisiPer").hide();
            }
            else
                $("#divVisiPer").show();
        }
        else if (checkboxValue == 'ADMIN') {
            if (isChecked) {
                $("#divVisiPer").show();
            }
            else
                $("#divVisiPer").hide();
        }

    }
</script>
